<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Array Input Form</title>
    <link rel="stylesheet" href="style.css"> <!-- External CSS if needed -->
</head>
<body>

    <h1>Enter Values to Add to the Array</h1>

    <!-- Input for image (first value) -->
    <label for="imageInput">Upload Image (First Value):</label>
    <input type="file" id="imageInput" accept="image/*">

    <!-- Input for text (second value) -->
    <label for="textInput1">Enter Text (Second Value):</label>
    <input type="text" id="textInput1" placeholder="Enter some text">

    <!-- Input for text (third value) -->
    <label for="postid"></label>

    <button onclick="addValueToArray()">Add to Array</button>

    <div id="arrayDisplay">
        <h3>Current Array:</h3>
        <ul id="arrayList"></ul>
    </div>

    <!-- Link to external JavaScript file -->
    <script src="blazzie.js"></script>

    <!-- Add a button to display a random item from the array -->
    <button onclick="displayRandomItem()">Display Random Post</button>

    <!-- Area to display the random post -->
    <div id="randomPostDisplay">
        <h3>Random Post:</h3>
        <ul id="randomPostList"></ul>
    </div>

</body>
</html>

const array = [];
const userid = "0";
let userpostsvar = 1; // Make sure this is a `let` so it can be incremented
let storedPosts = []; // This stores all the posts created
let viewedposts = [];  // This will store the posts the user has viewed

// Function to add value to the array
function addValueToArray() {
    const imageInput = document.getElementById('imageInput');
    const textInput1 = document.getElementById('textInput1');
    const postid = userid + userpostsvar.toString();

    // Get the file from image input (we'll store the image as a base64 string)
    const imageFile = imageInput.files[0];

    if (!imageFile) {
        alert('Please upload an image.');
        return;
    }

    // Convert the image file to a base64 string
    const reader = new FileReader();
    reader.onloadend = function () {
        const imageData = reader.result;

        // Create an object with the image data, text, and post ID
        const newItem = {
            image: imageData,
            text: textInput1.value,
            postId: postid
        };

        // Add the new item to the array
        array.push(newItem);

        // Increment userpostsvar for the next post ID
        userpostsvar++;

        // Update the display of the array
        displayArray();
    };

    // Read the file as a data URL (base64)
    reader.readAsDataURL(imageFile);
    clearInputs();
}

// Function to store an array in memory
function storeArrayinPosts(array) {
    storedPosts.push([...array]);  // Create a copy of the array and store it in storedPosts
}

// Function to clear the text inputs and image input
function clearInputs() {
    const imageInput = document.getElementById('imageInput');
    const textInput1 = document.getElementById('textInput1');

    textInput1.value = '';  // Clear text input
    imageInput.value = '';  // Clear image input
}

// Function to display the array contents on the page
function displayArray() {
    const arrayList = document.getElementById('arrayList');
    arrayList.innerHTML = '';  // Clear the current list

    array.forEach((item, index) => {
        const listItem = document.createElement('li');

        const img = document.createElement('img');
        img.src = item.image;
        img.alt = 'Uploaded Image';
        img.style.width = '100px'; // Adjust image size
        img.style.height = '100px';

        const text = document.createElement('p');
        text.textContent = item.text;

        const postId = document.createElement('p');
        postId.textContent = 'Post ID: ' + item.postId;

        listItem.appendChild(img);
        listItem.appendChild(text);
        listItem.appendChild(postId);

        arrayList.appendChild(listItem);
        storeArrayinPosts(array);  // Store the array after displaying
    });
}

// Function to display a random post from the array
function displayRandomItem() {
    if (array.length === 0) {
        alert("No posts available.");
        return;
    }

    // Randomly select an index from the array
    const randomIndex = Math.floor(Math.random() * array.length);
    const randomPost = array[randomIndex];

    // Check if the postId of the randomly selected item exists in storedPosts
    const isPostIdInStoredPosts = storedPosts.some(post => post.some(item => item.postId === randomPost.postId));

    if (isPostIdInStoredPosts) {
        displayrandom(randomPost); // Pass the randomPost to displayrandom
    } else {
        alert("Post ID not found in stored posts.");
    }

    // Check if the post has already been viewed
    if (viewedposts.includes(randomPost.postId)) {
        displayrandom()
    }else {
        // If not, mark as viewed and add to the viewedpost array
        viewedposts.push(randomPost.postId);
        console.log('Post Viewed:', randomPost.postId);
    }
    // Get the random post display area
    const randomPostList = document.getElementById('randomPostList');
    randomPostList.innerHTML = '';  // Clear previous content

    // Create a new list item to display the random post
    const listItem = document.createElement('li');

    const img = document.createElement('img');
    img.src = randomPost.image;
    img.alt = 'Uploaded Image';
    img.style.width = '100px';  // Adjust image size
    img.style.height = '100px';

    const text = document.createElement('p');
    text.textContent = randomPost.text;

    const postId = document.createElement('p');
    postId.textContent = 'Post ID: ' + randomPost.postId;

    listItem.appendChild(img);
    listItem.appendChild(text);
    listItem.appendChild(postId);

    randomPostList.appendChild(listItem);
}

// Function to display the random post
function displayrandom(post) {
    console.log('Random Post:', post);
}
